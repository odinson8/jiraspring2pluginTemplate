<!-- 
Written by Veniture

TODO
Ä°ssue Link olsun
-->

$webResourceManager.requireResource("com.veniture.resourceManagement:resourceManagement-resources")

<html>

<head>
    <title>FLO DEMO</title>

    <script src="http://code.jquery.com/jquery-1.11.3.min.js"></script>

    <link href="https://nightly.datatables.net/css/jquery.dataTables.css" rel="stylesheet" type="text/css" />
    <script src="https://nightly.datatables.net/js/jquery.dataTables.js"></script>

    <link href="https://nightly.datatables.net/select/css/select.dataTables.css?_=9a6592f8d74f8f520ff7b22342fa1183.css" rel="stylesheet" type="text/css" />
    <script src="https://nightly.datatables.net/select/js/dataTables.select.js?_=9a6592f8d74f8f520ff7b22342fa1183"></script>


    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@9"></script>

    <meta name="decorator" content="atl.general">
    <script>
        AJS.$(document).ready(function() {
            displayFooter = function() {
                table = AJS.$('#example').DataTable();

                // Total over all pages
                var intVal = function(i) {
                    return typeof i === 'undefined' ? 0 : i * 1;
                };

                var totalize_filtered = function(col) {
                    var data = table.column(col, {
                        search: 'applied'
                    }).data();
                    if (typeof data != 'undefined') {
                        return data
                            .reduce(function(a, b) {
                                    return intVal(a) + intVal(b);
                                },
                                0);
                    } else {
                        return 0;
                    }
                };

                var totalize_selected = function(col) {
                    var data = table.cells('.selected', col).data();
                    if (typeof data != 'undefined') {
                        return data
                            .reduce(function(a, b) {
                                    return intVal(a) + intVal(b);
                                },
                                0);
                    } else {
                        return 0;
                    }
                };
                var apply_footer = function(kapasite,col) {
                    AJS.$(table.column(col).footer()).html(
                        ' ' + (kapasite - totalize_selected(col))
                    );
                };
         
                apply_footer($kapasiteSap,3);
                apply_footer($kapasiteAbap,2);

            };

            var table = AJS.$('#example').DataTable({
                select: true,
                footerCallback: function(row, data, start, end, display) {
                    displayFooter();
                }
            });

            table.on('select.dt deselect.dt', function() {
                displayFooter();
            });
        });
    </script>
</head>

<body id="jira>
    <div class=" content-container">
        <div class="content-body">
            <div class="container">
                <div class="aui-group">
                    <div class="aui-item" id="issueTableDiv">
                        <table id="example" class="display nowrap" width="100%">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Summary</th>
                                    <th>Abap($kapasiteAbap)</th>
                                    <th>Sap($kapasiteSap)</th>
                                </tr>
                            </thead>
                        
                            <tfoot>
                                <tr>
                                    <th></th>
                                    <th>Total</th>
                                    <th></th>
                                    <th></th>
                                </tr>
                            </tfoot>
                        
                            <tbody>
                                #foreach( $issue in $issues )
                                <tr>
                                    <td>$issue.getKey()</td>
                                    <td>$issue.getSummary()</td>
                                    <td class="gerekliAbapEfor">$issue.getCustomFieldValue($gerekliAbapEforCf)</td>
                                    <td class="gerekliSapEfor">$issue.getCustomFieldValue($gerekliSapEforCf)</td>
                                </tr>
                                #end
                            </tbody>
                        </table>
                        <button class="aui-button" id="calculateButton">Calculate</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>

</html>